# Hybrid-Image-Encryption
A new image encryption technique 
Abstract— The objective of this paper is to study different image encryption algorithms and generate a hybrid algorithm by combining the best components from each method. Three channels of a color image called red, green and blue is arranged into one dimensional vector and sort according to chaotic sequence generated by Piecewise Linear Chaotic Map. After that S-box generated by the usage of all 16 distinct degree 8 primitive irreducible polynomials is used to substitute the pixels of image. The final encrypted image can be obtained by a pixel transposition step. 

Keywords —Chaos theory, Galois field, Irreducible polynomials, S-Box, Image Encryption, cryptosystems, Lorenz System, Chen’s hyper-system

Introduction 

The rapid expansion of digital technologies has made the traffic of communication fast and informal. Though, due to the openness of wireless networks such as the internet, the confidentiality of secret information is a serious problem.
Cryptography is the study of sharing confidential information over the unsecured channel, which deals with encryption, decryption, and key distribution, etc. Cryptography distributes further into two classes, symmetric, and asymmetric key cryptography. This distribution is made based on the secret key.
In Symmetric Cryptography is an encryption system the sender and receiver of the message uses a single common key to encrypt and decrypt messages. They are faster and simpler, but the problem is that sender and receiver must secretly exchange key in a secure manner. The most popular algorithm is Data Encryption System (DES).
In Asymmetric system a pair of keys is used to encrypt and decrypt information. A public key is used for the encryption and a private key is used for the decryption. Public key and Private Key are different to each other. Even if the public key is known by everyone the genuine receiver can only decode it because he only knows the private key.
Image is a very sensitive information. Even a normal selfie can be misused in many ways. Due to the extensive use of digital images in different fields, the security of digital image data gain attention extensively in the field of cryptography, that’s why we are proposing a new crypto algorithm for image encryption.
Literature Survey
An efficient version of image encryption using chaos theory is done in [14].
[15] tried to improve the S-box based image encryption algorithms by the usage of all 16 distinct degree 8 primitive irreducible polynomials.
In symmetric-key cryptography substitution box (S-box) is the only main component responsible to produce confusion among the key and the plaintext. Thus, a good quality S-box is essential 
to improve the nonlinearity of block ciphers. Recently many algorithms have been suggested for the construction of S-boxes [1, 2, 3].
Many algorithms for digital encryption based on chaos theory, have been presented in the last decade [4, 5, 6], subsequently, some of them are proved to be unsecured against different attacks, due to defect in their internal structure [8].
Li et al. examined the algorithm presented in [9] and established that encryption schemes based on only pixel position permutations and substitution can easily be broken over the chosen-plaintext attack. Zang et al. explored the weakness in the security of the image encryption scheme based on the perceptron model given in [7] and concluded that the secret key can be rebuilt easily if just one pair of plaintexts or ciphertext is known.
Norouzi et al. [10] devised an image encryption technique utilizing a hyperchaotic system that creates diffusion in a single round. Whereas Zong et al. [11] observed error in the technique; this technique is not secure against attacks like chosen plaintext.

PWLCM
In the proposed algorithm, three different chaotic systems of different dimension have been employed to add more complexity where each chaotic system has its own features. For PWLCM given in Eq. (1), the sensitivity to initial condition and control parameter are both considered as 10−12 [16],

a_(i+1)={█(a_i/p_0 ,0≤a_i<p_0@(a_i-p_0)/(0.5-p_0 ),      p_0≤a_i<0.5  @1-a_i 〖,a〗_i≥0.5)┤		( 1 )


Chen’s system
Chen’s hyper-chaotic system is highly sensitive to initial values and control parameters; is described as Eq. (2) as in [17],

u ̇=a(v-u)
v ̇=-uw+du+cu-x		( 2 )
w ̇=uv-bw
x ̇=u+k
In Eq. (2), a, b, c, d, k are the system parameters, when a = 36, b = 3, c = 28, d = 16 and −0.7 ≤ k ≤ 0.7, the Chen’s hyper-chaotic system is in the chaotic state and can generate four chaotic sequences. In this paper, parameter k = 0.2 is used to generate Chen’s chaotic sequence. Here, four-order Runge–Kutta method is applied to solve the equations and get the sequences U, V, W and X and then sequences are combined into one array.
Lorenz’ system
Lorenz system is a mathematical model of weather forecasting, given as [18]: 

y ̇=-fy+fz
           z ̇=ry-z-yq		( 3 )
q ̇=-gq+yz
The above equation is a dynamical nonlinear system with two non-linearities yq, yz. The inputs f, g and r are constants physical characteristics of air flow, y represent amplitude of convective current in the air cell, z represents to the temperature difference between rising and falling currents, q to the deviation of temperature from normal temperature in the cell. No analytical solution exists for this nonlinear system, it first transformed into iterative form and numerical solution is then computed. The numerical solutions show that for 0 < r < 1, the overall system will have steady response, for 1 < r < 24the system will also be stable with periodic response, for r > 24, f = 10 and g = 8/3, the system yields chaotic response [18].

Methodology
Our encryption algorithm is based symmetric key cryptography. In symmetric-key cryptosystem, the interconnected parties use alike keys, while in an asymmetric key cryptosystem both parties use different keys namely public key and private key for secure communication.

Generate initial conditions and control parameters.
SHA-256 generates digest of 256 bits regardless the size of the input. If there is one-bit difference between two inputs, their message digest will be completely different [16]. So, this is used to generate digest of the color image to which encryption is to be done. The message digest is divided into two groups of hexadecimal values. The first group is divided into mj blocks of equal size where j = 1, 2, · · ·, 8. Each block contains seven hexadecimal digits and convert into a floating decimal number mj ∈ (0, 0.0156) using Eq. (4):

mj = hex2dec(m1, ..., m8)/234	( 4 )

The second group is directly converted into floating point valued (0, 0.0156)
d = hex2dec(d)/242		( 5 )

{█(a_0^'=a_0+m_1+CK@p_0^'=p_0+m_2+CK mod⁡1 )┤	( 6 )

Suppose that seed values for Chen’s are u0 , v0, w0 and x0 then new initial seed can be generated using Eq. (7) as follows,

{█(u_0^'=u_0+m_3+Ck@v_0^1=v_0+m_4+CK@w_0^'=w_0+m_5+CK 〖 mod〗⁡1@x_0^'=x_0+m_6+CK)┤	( 7 )

Three more seeds are required for Lorenz chaotic system which is calculated as follows:

{█(y_0^'=y_0+m_7+CK@z_0^'=z_0+m_8+CK mod⁡1@q_0^'=q_0+d+CK)┤	( 8 )

In above Equations, CK is the common key generated as follows,

CK = a0 + p0 + u0 + v0 + w0 + x0 + y0 + z0 + q0 mod 1	( 9 )

The dependence of keys on plain image makes sure to change for every input, hence more secure [16].
S-box which is used in the proposed approach is based on the action of general linear group G_L (2,F_(2^8 ) ) on finite field F_(2^8 )  of order 256.

w: GL(2,F_(2^8 ) )"×" F_(2^8 )→F_(2^8 )

w(M,y)=F_M (y)		( 10 )

where F_M (y)=(α(y)+β)/(γ(y)+δ) and α, β, γ and δ are the elements of F_(2^8 ). F_M is a bijective mapping from F_(2^8 ) to F_(2^8 ), and the resultant values of F_M are then converted into a 16x16 lookup table, which is the required S-box.

Encryption Process
Permutation Step – The proposed diffusion of color image is performed in two ways; first one is done by combining all three channels image I into 1-Dimensional array of size 1 × 3MN and then sort according to a chaotic sequence A. This chaotic sequence A is generated by iterating PWLCM up to 3MN times a0 and p0 and permute pixels of I as follows

A={a_i,a_(i+1),…,a_3MN }
[valA,idxA]=sort(A)		( 11 )
I^'=I(idx⁡A )

After this, I^' is split into three arrays of size 1 × MN called red, green and blue as follows,

R=[I^' (1),I^' (2),…,I'(MN)]
G=[I^' (MN+1),I^' (MN+2),…,I'(2MN)]( 12 )
B=[I^' (2MN+1),I^' (2MN+2),…,I'(3MN)]

The second permutation is performed on the above channels R, G and B independently. For this, Loren’z system of equation used to generate three pseudo-random sequences Y, Z, and Q of size t + MN using initial seed y_0^', z_0^' and q_0^' to shuffle the pixels of three channels. The t values are discarded to avoid transient effect and sort three sequences as,

[valY,idxY]=sort(Y)
  [valZ,idxZ]=sort(Z)		( 13 )
[valQ,idxQ]=sort(Q)

where idxY, idxZ and idxQ are index value of sorted Y, Z and Q and rearrange the elements of R, G and B according to idxY, idxZ and idxQ to get permuted image as shown in following equation,

{█(R_p (i)=R(idxY(i))@G_p (i)= G(idxZ(i))@B_p (i)=B(idxQ(i)))┤		( 14 )

S-Box Substitution - In this step, we substitute the obtained permuted matrices using sixteen S-boxes to enhance the nonlinearity of the proposed scheme. For S-boxes generation, we chose the set of all degree 8 primitive irreducible polynomials over the field ℤ2;
{h_j (y)∈Z_2 [y]:h_j (y)  is irreducible,1≤j≤16}
Thus for each j the quotient ring  (Z_2 [y])/⟨h_j (y)⟩  form a field isomorphic to the Galois field GF(28). Accordingly, the nonzero elements of each of these fields form a group known as the Galois cyclic group generated by the primitive element ai, corresponding to the irreducible polynomial hj(y). The list of Galois fields against their primitive irreducible polynomials is given in Table 1. For S-boxes construction, we used the above degree 8 primitive irreducible polynomials and the action of the general linear group over a newly designed finite field is defined as;

Table 1: Primitive irreducible polynomials and their corresponding Galois fields
 

w_j:GL(2,(Z_2 [y])/⟨h_j (y)⟩   )"×"  (Z_2 [y])/⟨h_j (y)⟩   →(Z_2 [y])/⟨h_j (y)⟩ 		( 15 )

F_jA (y)=(α(y)+β)/(γ(y)+δ)			( 16 )

Where A=[■(α&β@γ&δ)] ∈ GL(2,(Z_2 [y])/⟨h_j (y)⟩   ). For a M and for each j, 1 ≤ j ≤ 16 FjA give us sixteen S-boxes having diverse algebraic and statistical properties. Moreover, over the cryptographic properties of these S-boxes are closed to the standard S-box of AES and APA S-box, the justification is given [12]. Furthermore, we divide the permuted color components RP, GP and BP into sixteen sub-blocks, and substitute each sunblock with a different S-box. At last, after the use of these newly generated sixteen S-boxes, we combine the substituted sub-blocks and obtained three substituted blocks RS, GS and BS.

Pixel transposition step – For the pixels, transposition generate a sequence (xn) from 1 up toM×N respectively. Then convert each element of the sequence into the range of 0 − 255 using the following equation:
xn′=mod(xn,256)			( 17 )
In the next step by using the multiplicative operation of a group (Z_2 [y])/⟨h_1 (y)⟩  ∖{0} and generate a three random sequence from x′ with the help of following equations;
xR = a × xn′ mod h1(y)		( 18 )
xG = b × xn′ mod h3(y)		( 19 )
xB = c × xn′ mod h4(y)		( 20 )

Where a, b and c are the elements of the set (Z_2 [y])/⟨h_1 (y)⟩  ∖{0,1}. After getting matrices xR, xG and xB, permute each matrix.
For this, Chen’s hyper system is iterated (t+ MN) times using initial secret key u_0^', v_0^' , w_0^' and x_0^' to get four pseudo-random chaotic sequences U, V, W and X. The first t values are discarded to avoid transient effect and sort three sequences xR, xG and xB as,

[valU,idxU]=sort(U)
[valV,idxV]=sort(V)		( 21 )
[valW,idxW]=sort(W)

where idxU, idxV and idxW are index value of sorted U, V and W and rearrange the elements of xR, xG and xB according to idxY, idxZ and idxQ to get permuted image as shown in following equation,


{█(x_R'(i)=x_R (idxY(i))@x_G'(i)= x_G (idxZ(i))@x_B'(i)=x_B (idxQ(i)))┤		( 22 )

Then transpose the substituted blocks using the following formulas:
RE = bitxor ( xR′,RS)		( 23 )
GE = bitxor ( xG′,GS)		( 24 )
BE = bitxor ( xB′,BS)		( 25 )
Then combine RE, GE and BE matrices and recover the encrypted RGB image. 

Decryption Process
Pixel transposition step - The decryption process of the proposed scheme is the same as the encryption process, but it starts from the reverse side. Convert the encrypted image into three matrices RE, GE and BE. The first round of the reverse processes is the same as the step which we have discussed in pixel transposition step, and get back the matrices RS,GS and BS.
Inverse S-Box substitution - In this step, we generate the inverse S-box utilize degree 8 primitive irreducible polynomials given in the table, 1. The inverse sixteen S-boxes are generated using the following inverse map:
		  F_jM (y)=(δ(y)+β)/(γ(y)+α)			( 26 )
Then divided the matrices RS, GS and BS into sixteen sub-blocks, substitute each sub-block with inverse S-box and then combine the sub-blocks to obtain the matrices RP, GP and BP.
Inverse Permutation – We repeat the permutation step of the encryption process in reverse manner using pseudo-random sequences Y, Z, and Q generated from Loren’z System and chaotic sequence A generated from PWLCM. And after doing the permutation we get the original image .
